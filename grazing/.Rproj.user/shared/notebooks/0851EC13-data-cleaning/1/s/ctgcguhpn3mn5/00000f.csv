"0","###### CALCULATE BITE RATES #####"
"0","#First count the number of bites (n) per site/GoPro"
"0","countbites <- herbivores %>%"
"0","  group_by(Site, GoPro, Site.GoPro)  %>% "
"0","  dplyr::count(sort = TRUE) "
"0",""
"0","# Combine bite rates with field data"
"0","filter <- countbites %>%"
"0","  ungroup() %>%"
"0","  dplyr::select(""Site.GoPro"", ""n"") %>%"
"0","  rename(n.bites=n)"
"0",""
"0","filter <- as.data.frame(filter) "
"0","filter$Site.GoPro <- dplyr::recode(filter$Site.GoPro, "
"0","                                   ""Il Poule Seaward.G "" = ""Il Poule Seaward.G"") # fix spacing error"
"0",""
"0","herbivore.bites <- left_join(filter, "
"0","                       field.data, by = c(""Site.GoPro""))"
"0",""
"0","#create a new column called bites.per.hour"
"0","herbivore.bites[,""bites.per.hour""] <- NA"
"0",""
"0","#fill bites.per.hour (bites divided by video length)"
"0","herbivore.bites$bites.per.hour <- herbivore.bites$n.bites / herbivore.bites$Video_length"
"0",""
"0","#create bites per min "
"0","herbivore.bites[,""bites.per.min""] <- NA"
"0","herbivore.bites$bites.per.min <- herbivore.bites$bites.per.hour / 60"
"0",""
"0","# Add back in the two gopros from the lagoon that have no bites at all from herbivores"
"0","# Il Anglaise Lagoon.A"
"0","# Il Anglaise Lagoon.D"
"0","# Il Anglaise Lagoon.H"
"0",""
"0",""
"0","herbivore.bites <- herbivore.bites %>%"
"0","  add_row(Site.GoPro = ""Il Anglaise Lagoon.A"", "
"0","          Island = ""Salomon"","
"0","          Site = ""Il Anglaise Lagoon"","
"0","          Atoll= ""Salomon"","
"0","          bites.per.min = 0,"
"0","          bites.per.hour= 0) %>%"
"0","    add_row(Site.GoPro = ""Il Anglaise Lagoon.D"", "
"0","          Island = ""Salomon"","
"0","          Site = ""Il Anglaise Lagoon"","
"0","          Atoll= ""Salomon"","
"0","          bites.per.min = 0,"
"0","          bites.per.hour= 0) %>%"
"0","    add_row(Site.GoPro = ""Il Anglaise Lagoon.H"", "
"0","          Island = ""Salomon"","
"0","          Site = ""Il Anglaise Lagoon"","
"0","          Atoll= ""Salomon"","
"0","          bites.per.min = 0,"
"0","          bites.per.hour= 0)"
"0",""
"0","dim(herbivore.bites) # now all 35 gopros are there"
"1","[1]"
"1"," 35"
"1"," 15"
"1","
"
"0","##### DIVIDE BY GRAZEABLE SUBSTRATE #######"
"0","# Add in benthic data"
"0","unique(herbivore.bites$Site.GoPro)"
"1"," [1]"
"1"," ""Il Anglaise Lagoon.E"" "
"1"," ""Il Anglaise Seaward.H"""
"1"," ""Middle Brother.A""     "
"1"," ""Middle Brother.G""     "
"1","
"
"1"," [5]"
"1"," ""Il Lubine.B""          "
"1"," ""Il Anglaise Seaward.A"""
"1"," ""Il de rats.E""         "
"1"," ""Il Lubine.A""          "
"1","
"
"1"," [9]"
"1"," ""Il de rats.A""         "
"1"," ""Il de rats.I""         "
"1"," ""Il Anglaise Seaward.I"""
"1"," ""Il Anglaise Seaward.E"""
"1","
"
"1","[13]"
"1"," ""Il Poule Seaward.D""   "
"1"," ""Il Poule Seaward.G""   "
"1"," ""Il Lubine.H""          "
"1"," ""Nelson.G""             "
"1","
"
"1","[17]"
"1"," ""Il Anglaise Seaward.B"""
"1"," ""Nelson.D""             "
"1"," ""Il Anglaise Lagoon.B"" "
"1"," ""Nelson.A""             "
"1","
"
"1","[21]"
"1"," ""Il de rats.B""         "
"1"," ""Il de rats.H""         "
"1"," ""Il Lubine.I""          "
"1"," ""Il Poule Seaward.A""   "
"1","
"
"1","[25]"
"1"," ""Middle Brother.H""     "
"1"," ""Il Poule Seaward.B""   "
"1"," ""Middle Brother.E""     "
"1"," ""Il Lubine.E""          "
"1","
"
"1","[29]"
"1"," ""Middle Brother.I""     "
"1"," ""Il Poule Seaward.I""   "
"1"," ""Nelson.B""             "
"1"," ""Nelson.E""             "
"1","
"
"1","[33]"
"1"," ""Il Anglaise Lagoon.A"" "
"1"," ""Il Anglaise Lagoon.D"" "
"1"," ""Il Anglaise Lagoon.H"" "
"1","
"
"0","unique(benthic.final$Site.GoPro)"
"1"," [1]"
"1"," ""Il Lubine.I""          "
"1"," ""Il Anglaise Seaward.A"""
"1"," ""Il Anglaise Seaward.B"""
"1"," ""Il Anglaise Seaward.I"""
"1","
"
"1"," [5]"
"1"," ""Il de rats.A""         "
"1"," ""Il de rats.B""         "
"1"," ""Il de rats.E""         "
"1"," ""Il de rats.H""         "
"1","
"
"1"," [9]"
"1"," ""Il Poule Seaward.G""   "
"1"," ""Il Poule Seaward.I""   "
"1"," ""Il Lubine.A""          "
"1"," ""Il Lubine.B""          "
"1","
"
"1","[13]"
"1"," ""Il Lubine.H""          "
"1"," ""Il Poule Seaward.D""   "
"1"," ""Middle Brother.A""     "
"1"," ""Middle Brother.E""     "
"1","
"
"1","[17]"
"1"," ""Middle Brother.H""     "
"1"," ""Middle Brother.I""     "
"1"," ""Nelson.A""             "
"1"," ""Nelson.B""             "
"1","
"
"1","[21]"
"1"," ""Nelson.E""             "
"1"," ""Nelson.G""             "
"1"," ""Il Poule Seaward.A""   "
"1"," ""Il Poule Seaward.B""   "
"1","
"
"1","[25]"
"1"," ""Il Anglaise Lagoon.E"" "
"1"," ""Il Anglaise Lagoon.H"" "
"1"," ""Il Anglaise Seaward.H"""
"1"," ""Il de rats.I""         "
"1","
"
"1","[29]"
"1"," ""Il Lubine.E""          "
"1"," ""Middle Brother.G""     "
"1"," ""Nelson.D""             "
"1"," ""Il Anglaise Lagoon.A"" "
"1","
"
"1","[33]"
"1"," ""Il Anglaise Lagoon.B"" "
"1"," ""Il Anglaise Lagoon.D"" "
"1"," ""Il Anglaise Seaward.E"""
"1","
"
"0","df1 <- left_join(herbivore.bites, benthic.final, by=""Site.GoPro"")"
"0",""
"0","df2 <- df1 %>% "
"0","  mutate(bites.per.min.grazeable = bites.per.min/Grazeable.substrate)"
"0",""
"0","# Mean bites per site"
"0","herbivore.bites.site <- df2 %>%"
"0","  group_by(Site) %>%"
"0","  summarize(bites.per.min.grazeable.mean= mean(bites.per.min.grazeable),"
"0","            bites.per.min.mean= mean(bites.per.min)) # calculate the average for each site "
"0",""
"0","# Save the data (this is used for the coral models)"
"0","save(herbivore.bites.site, file = ""../data/bite.data.Rdata"")"
"0",""
"0",""
"0",""
"0",""
"0","##### ADD IN FISH/SHARK DATA #####"
"0","# Add in shark data"
"0","unique(df2$Island)"
"1","[1]"
"1"," ""Salomon""       "
"1"," ""Middle Brother"""
"1"," ""Egmont""        "
"1"," ""Peros Banos""   "
"1"," ""Nelson""        "
"1","
"
"0","View(mean.shark.abundance.tiles)"
"0",""
"0","# manually add in mean shark abundance"
"0","herbivore.bites.shark <- df2 %>% "
"0","  mutate(Shark_Sum_Abundance= ifelse(Island %in% ""Egmont"", 6.9, ifelse(Island %in% ""Salomon"", 4.8, ifelse(Island %in% ""Peros Banos"", 3.8, ifelse(Island %in% ""Middle Brother"", 2.9, 3.1)))))"
"0",""
"0","# Add in Fish Data "
"0","load(""../../dovs/data/created/fish.site.tiles.average.RData"") # fish.site.tiles.average"
"0","unique(herbivore.bites.shark$Site)"
"1","[1]"
"1"," ""Il Anglaise Lagoon"" "
"1"," ""Il Anglaise Seaward"""
"1"," ""Middle Brother""     "
"1"," ""Il Lubine""          "
"1","
"
"1","[5]"
"1"," ""Il de rats""         "
"1"," ""Il Poule Seaward""   "
"1"," ""Nelson""             "
"1","
"
"0","unique(fish.site.tiles.average$Tile.Site)"
"1","[1]"
"1"," ""Il de rats""          "
"1"," ""Il Lubine""           "
"1"," ""Middle Brother""      "
"1"," ""Nelson""              "
"1","
"
"1","[5]"
"1"," ""Peros Banhos Lagoon"" "
"1"," ""Peros Banhos Seaward"""
"1"," ""Salomon lagoon""      "
"1"," ""Salomon seaward""     "
"1","
"
"0","# Make the names match"
"0","test <- herbivore.bites.shark %>%"
"0","  mutate(Tile.Site= ifelse(Site == ""Il Lubine"", ""Il Lubine"","
"0","                            ifelse(Site == ""Il de rats"", ""Il de rats"","
"0","                                   ifelse(Site == ""Nelson"", ""Nelson"","
"0","                                   ifelse(Site == ""Middle Brother"", ""Middle Brother"","
"0","                                          ifelse(Site == ""Il Anglaise Lagoon"", ""Salomon lagoon"","
"0","                                                 ifelse(Site == ""Il Anglaise Seaward"", ""Salomon seaward"","
"0","                                                        ifelse(Site == ""Il Poule Lagoon"", ""Peros Banhos Lagoon"", ""Peros Banhos Seaward""))))))))"
"0",""
"0","fish <- fish.site.tiles.average %>%"
"0","  ungroup() %>%"
"0","  select(-Atoll)"
"0",""
"0","herbivore.bites.shark.fish <- left_join(test, fish, by=""Tile.Site"") "
"0","dim(herbivore.bites.shark.fish)"
"1","[1]"
"1"," 35"
"1"," 23"
"1","
"
"0","View(herbivore.bites.shark.fish)"
