"0","traits <- read.csv(""../data/traits/Chagos Fish Traits v2 - OVERALL-coarse.csv"", stringsAsFactors = FALSE) "
"0",""
"0","# add in the unidentified baitfish"
"0","traits <- traits %>% add_row(Full.Species.Name= ""Unidentified baitfish"", TrophicGroup= ""#N/A"","
"0","                               BodySize= ""#N/A"", AggregationSize= ""#N/A"", ActivityPeriod= ""#N/A"","
"0","                               WaterColumn= ""#N/A"", HomeRange= ""#N/A"")"
"0",""
"0","# create FEs"
"0","traits <- traits %>% "
"0","  mutate(FE =str_c(BodySize, ""."", "
"0","                   TrophicGroup, ""."", AggregationSize, ""."", "
"0","                   ActivityPeriod, ""."", WaterColumn, ""."", HomeRange))"
"0",""
"0",""
"0","traits.reef <- traits %>%"
"0","  filter(Full.Species.Name %in% dovs.long.reef$Full.Species.Name)"
"0","traits.reef$TrophicGroup <- as.factor(traits.reef$TrophicGroup)"
"0","traits.reef$BodySize <- as.factor(traits.reef$BodySize)"
"0","traits.reef$AggregationSize <- as.factor(traits.reef$AggregationSize)"
"0","traits.reef$ActivityPeriod <- as.factor(traits.reef$ActivityPeriod)"
"0","traits.reef$WaterColumn <- as.factor(traits.reef$WaterColumn)"
"0","traits.reef$HomeRange <- as.factor(traits.reef$HomeRange)"
"0","  "
"0",""
"0","# combine the traits data with the dovs data, need to remove family from full.species.name"
"0","traits.long.reef <- left_join(dovs.long.reef, select(traits.reef, c(1,3,6:11, 13)), by=""Full.Species.Name"")"
"2","Column `Full.Species.Name` joining factor and character vector, coercing into character vector"
"0","# create a wide version for FE (not species)"
"0","df1 <- traits.long.reef %>% "
"0","  group_by(Shark_Abundance, Atoll, Location, Site, Year, OpCode_transect, FE) %>%"
"0","  summarize(FE.Abundance= sum(Abundance))"
"0",""
"0","FE.reef.wide <- reshape2::dcast(df1, Shark_Abundance +Atoll + Location + Site + Year + OpCode_transect ~ FE, value.var = 'FE.Abundance')"
