"0","## Calculate the effect size for each site"
"0","macro.es <- with(effectsize.df,"
"0","            by(effectsize.df, Tile.Site,"
"0","               function(x) cohen.d(x$Macroalgae, x$Treatment, hedges.correction = TRUE)))"
"0",""
"0",""
"0","# Save the data for each site"
"0","hedges.macro.pb.lagoon <- macro.es$`Peros Banhos Lagoon`"
"0","hedges.macro.pb.seaward  <- macro.es$`Peros Banhos Seaward`"
"0","hedges.macro.salo.seaward <- macro.es$`Salomon seaward`"
"0","hedges.macro.salo.lagoon <- macro.es$`Salomon lagoon`"
"0","hedges.macro.nelson <- macro.es$Nelson"
"0","hedges.macro.midbro <- macro.es$`Middle Brother`"
"0","hedges.macro.rats <-macro.es$`Il de rats`"
"0","hedges.macro.lubine <-macro.es$`Il Lubine`"
"0",""
"0","# Combine"
"0","Site <- c(""Peros Banhos Lagoon"", ""Peros Banhos Seaward"", ""Salomon Seaward"", ""Salomon Lagoon"", ""Nelson"", ""Middle Brother"", ""Il de rats"", ""Il lubine"")"
"0",""
"0","macro.estimate <- c(hedges.macro.pb.lagoon$estimate, "
"0","                  hedges.macro.pb.seaward$estimate, "
"0","                  hedges.macro.salo.seaward$estimate, "
"0","                  hedges.macro.salo.lagoon$estimate, "
"0","                  hedges.macro.nelson$estimate, "
"0","                  hedges.macro.midbro$estimate, "
"0","                  hedges.macro.rats$estimate, "
"0","                  hedges.macro.lubine$estimate)"
"0",""
"0","macro.sd <- c(hedges.macro.pb.lagoon$sd, "
"0","            hedges.macro.pb.seaward$sd, "
"0","            hedges.macro.salo.seaward$sd, "
"0","            hedges.macro.salo.lagoon$sd, "
"0","            hedges.macro.nelson$sd, "
"0","            hedges.macro.midbro$sd, "
"0","            hedges.macro.rats$sd, "
"0","            hedges.macro.lubine$sd)"
"0",""
"0","hedges.macro.df <- as.data.frame(cbind(Site, macro.estimate, macro.sd))"
"0","hedges.macro.df$macro.estimate <- as.numeric(hedges.macro.df$macro.estimate)"
"0","hedges.macro.df$macro.sd <- as.numeric(hedges.macro.df$macro.sd)"
"0",""
"0",""
"0",""
"0",""
"0","# Prep the data so it has the same colors as the bruvs data"
"0","hedges.macro.plot <- hedges.macro.df %>%"
"0","  mutate(Atoll = ifelse(Site == ""Peros Banhos Lagoon"", ""Peros Banhos"", "
"0","                        ifelse(Site == ""Peros Banhos Seaward"", ""Peros Banhos"","
"0","                        ifelse(Site == ""Salomon Seaward"", ""Salomon"","
"0","                               ifelse(Site == ""Salomon Lagoon"", ""Salomon"","
"0","                                      ifelse(Site == ""Nelson"", ""Nelson"","
"0","                                             ifelse(Site== ""Middle Brother"", ""Brothers"","
"0","                                                    ""Egmont"")))))))"
"0",""
"0","hedges.macro.plot$Atoll <- factor(hedges.macro.plot$Atoll, "
"0","                                  levels=c(""Brothers"", ""Nelson"","
"0","                                           ""Peros Banhos"", ""Salomon"", ""Egmont""))"
"0",""
"0",""
"0",""
"0","# Calculate grand mean"
"0","macro.mean <- hedges.macro.plot %>%"
"0","  summarize(mean=mean(macro.estimate),"
"0","            sd=sd(macro.estimate))"
"0",""
"0","# add back to data"
"0","hedges.macro.plot <- hedges.macro.plot %>%"
"0","  add_row(Site=""Overall"", "
"0","          macro.estimate=macro.mean$mean,"
"0","          macro.sd=macro.mean$sd, Atoll=NA)"
"0",""
"0",""
"0","hedges.macro.plot$Site <- factor(hedges.macro.plot$Site, "
"0","                           levels=c(""Middle Brother"", ""Nelson"", ""Peros Banhos Lagoon"", "
"0","""Peros Banhos Seaward"", "
"0","""Salomon Lagoon"", ""Salomon Seaward"", ""Il de rats"", ""Il lubine"", ""Overall""))"
"0",""
"0",""
"0",""
"0","# Effect size by site"
"0","p_tiles.algae.effectsize <- ggplot(hedges.macro.plot, "
"0","                                   aes(x=Site, y=macro.estimate, col=Atoll)) +"
"0","   geom_point(size=c(6,6,6,6,6,6,6,6,9), "
"0","              shape=(values=c(19,19,19,19,19,19,19,19,18)))+"
"0","  geom_errorbar(aes(ymin = macro.estimate-macro.sd, "
"0","                    ymax = macro.estimate+macro.sd), "
"0","                width=0.2) +"
"0","  labs (x= """", y= ""Macroalgae Effect Size"") +"
"0","  theme_pubr() +"
"0","  geom_hline(yintercept= 0, linetype=2) +"
"0","    theme_pubr(base_size = 16) + "
"0","  theme(axis.text.x = element_blank())+"
"0","  scale_color_manual(values= c(""#440154FF"",""#3B528BFF"",""#21908CFF"",""#5DC863FF"",""#FDE725FF"")) +"
"0","  guides(col = ""none"",shape=""none"")+"
"0","  geom_vline(xintercept=8.5, linetype=""dashed"")"
"0",""
"0","p_tiles.algae.effectsize"
