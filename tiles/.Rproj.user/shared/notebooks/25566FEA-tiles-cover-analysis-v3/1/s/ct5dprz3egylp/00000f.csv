"0","## Calculate the effect size for each site"
"0","turf.es <- with(effectsize.df,"
"0","            by(effectsize.df, Tile.Site,"
"0","               function(x) cohen.d(x$Turf, x$Treatment, hedges.correction = TRUE)))"
"0",""
"0",""
"0","# Save the data for each site"
"0","hedges.turf.pb.lagoon <- turf.es$`Peros Banhos Lagoon`"
"0","hedges.turf.pb.seaward  <- turf.es$`Peros Banhos Seaward`"
"0","hedges.turf.salo.seaward <- turf.es$`Salomon seaward`"
"0","hedges.turf.salo.lagoon <- turf.es$`Salomon lagoon`"
"0","hedges.turf.nelson <- turf.es$Nelson"
"0","hedges.turf.midbro <- turf.es$`Middle Brother`"
"0","hedges.turf.rats <-turf.es$`Il de rats`"
"0","hedges.turf.lubine <-turf.es$`Il Lubine`"
"0",""
"0","# Combine"
"0","Site <- c(""Peros Banhos Lagoon"", ""Peros Banhos Seaward"", ""Salomon Seaward"", ""Salomon Lagoon"", ""Nelson"", ""Middle Brother"", ""Il de rats"", ""Il lubine"")"
"0",""
"0","turf.estimate <- c(hedges.turf.pb.lagoon$estimate, "
"0","                  hedges.turf.pb.seaward$estimate, "
"0","                  hedges.turf.salo.seaward$estimate, "
"0","                  hedges.turf.salo.lagoon$estimate, "
"0","                  hedges.turf.nelson$estimate, "
"0","                  hedges.turf.midbro$estimate, "
"0","                  hedges.turf.rats$estimate, "
"0","                  hedges.turf.lubine$estimate)"
"0",""
"0","turf.sd <- c(hedges.turf.pb.lagoon$sd, "
"0","            hedges.turf.pb.seaward$sd, "
"0","            hedges.turf.salo.seaward$sd, "
"0","            hedges.turf.salo.lagoon$sd, "
"0","            hedges.turf.nelson$sd, "
"0","            hedges.turf.midbro$sd, "
"0","            hedges.turf.rats$sd, "
"0","            hedges.turf.lubine$sd)"
"0",""
"0","hedges.turf.df <- as.data.frame(cbind(Site, turf.estimate, turf.sd))"
"0","hedges.turf.df$turf.estimate <- as.numeric(hedges.turf.df$turf.estimate)"
"0","hedges.turf.df$turf.sd <- as.numeric(hedges.turf.df$turf.sd)"
"0",""
"0",""
"0",""
"0",""
"0","# Prep the data so it has the same colors as the bruvs data"
"0","hedges.turf.plot <- hedges.turf.df %>%"
"0","  mutate(Atoll = ifelse(Site == ""Peros Banhos Lagoon"", ""Peros Banhos"", "
"0","                        ifelse(Site == ""Peros Banhos Seaward"", ""Peros Banhos"","
"0","                        ifelse(Site == ""Salomon Seaward"", ""Salomon"","
"0","                               ifelse(Site == ""Salomon Lagoon"", ""Salomon"","
"0","                                      ifelse(Site == ""Nelson"", ""Nelson"","
"0","                                             ifelse(Site== ""Middle Brother"", ""Brothers"","
"0","                                                    ""Egmont"")))))))"
"0",""
"0","hedges.turf.plot$Atoll <- factor(hedges.turf.plot$Atoll, "
"0","                                  levels=c(""Brothers"", ""Nelson"","
"0","                                           ""Peros Banhos"", ""Salomon"", ""Egmont""))"
"0",""
"0",""
"0",""
"0","# Calculate grand mean"
"0","turf.mean <- hedges.turf.plot %>%"
"0","  summarize(mean=mean(turf.estimate),"
"0","            sd=sd(turf.estimate))"
"0",""
"0","# add back to data"
"0","hedges.turf.plot <- hedges.turf.plot %>%"
"0","  add_row(Site=""Overall"", "
"0","          turf.estimate=turf.mean$mean,"
"0","          turf.sd=turf.mean$sd, Atoll=NA)"
"0",""
"0",""
"0","hedges.turf.plot$Site <- factor(hedges.turf.plot$Site, "
"0","                           levels=c(""Middle Brother"", ""Nelson"", ""Peros Banhos Lagoon"", "
"0","""Peros Banhos Seaward"", "
"0","""Salomon Lagoon"", ""Salomon Seaward"", ""Il de rats"", ""Il lubine"", ""Overall""))"
"0",""
"0",""
"0",""
"0","# Effect size by site"
"0","p_tiles.turf.effectsize <- ggplot(hedges.turf.plot, aes(x=Site, y=turf.estimate, col=Atoll)) +"
"0","   geom_point(size=c(6,6,6,6,6,6,6,6,9), "
"0","              shape=(values=c(19,19,19,19,19,19,19,19,18)))+"
"0","  geom_errorbar(aes(ymin = turf.estimate-turf.sd, "
"0","                    ymax = turf.estimate+turf.sd), "
"0","                width=0.2) +  labs (x= ""Site"", y= ""Turf Effect Size"") +"
"0","  theme_pubr() +"
"0","  geom_hline(yintercept= 0, linetype=2) +"
"0","    theme_pubr(base_size = 16) + "
"0","  theme(axis.text.x = element_blank())+"
"0","  scale_color_manual(values= c(""#440154FF"",""#3B528BFF"",""#21908CFF"",""#5DC863FF"",""#FDE725FF"")) +"
"0","  guides(col = ""none"",shape=""none"")+"
"0","  geom_vline(xintercept=8.5, linetype=""dashed"")"
"0",""
"0","p_tiles.turf.effectsize"
