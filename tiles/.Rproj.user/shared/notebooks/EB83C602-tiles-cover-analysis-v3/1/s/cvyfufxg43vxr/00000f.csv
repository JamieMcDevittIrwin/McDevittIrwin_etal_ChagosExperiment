"0",""
"0","## Calculate the effect size for each site"
"0","cca.es <- with(effectsize.df,"
"0","            by(effectsize.df, Tile.Site,"
"0","               function(x) cohen.d(x$CCA, x$Treatment, hedges.correction = TRUE)))"
"0",""
"0",""
"0","# Save the data for each site"
"0","hedges.cca.pb.lagoon <- cca.es$`Peros Banhos Lagoon`"
"0","hedges.cca.pb.seaward  <- cca.es$`Peros Banhos Seaward`"
"0","hedges.cca.salo.seaward <- cca.es$`Salomon seaward`"
"0","hedges.cca.salo.lagoon <- cca.es$`Salomon lagoon`"
"0","hedges.cca.nelson <- cca.es$Nelson"
"0","hedges.cca.midbro <- cca.es$`Middle Brother`"
"0","hedges.cca.rats <-cca.es$`Il de rats`"
"0","hedges.cca.lubine <-cca.es$`Il Lubine`"
"0",""
"0","# Combine"
"0","Site <- c(""Peros Banhos Lagoon"", ""Peros Banhos Seaward"", ""Salomon Seaward"", ""Salomon Lagoon"", ""Nelson"", ""Middle Brother"", ""Il de rats"", ""Il lubine"")"
"0",""
"0","cca.estimate <- c(hedges.cca.pb.lagoon$estimate, "
"0","                  hedges.cca.pb.seaward$estimate, "
"0","                  hedges.cca.salo.seaward$estimate, "
"0","                  hedges.cca.salo.lagoon$estimate, "
"0","                  hedges.cca.nelson$estimate, "
"0","                  hedges.cca.midbro$estimate, "
"0","                  hedges.cca.rats$estimate, "
"0","                  hedges.cca.lubine$estimate)"
"0",""
"0","cca.sd <- c(hedges.cca.pb.lagoon$sd, "
"0","            hedges.cca.pb.seaward$sd, "
"0","            hedges.cca.salo.seaward$sd, "
"0","            hedges.cca.salo.lagoon$sd, "
"0","            hedges.cca.nelson$sd, "
"0","            hedges.cca.midbro$sd, "
"0","            hedges.cca.rats$sd, "
"0","            hedges.cca.lubine$sd)"
"0",""
"0","hedges.cca.df <- as.data.frame(cbind(Site, cca.estimate, cca.sd))"
"0","hedges.cca.df$cca.estimate <- as.numeric(hedges.cca.df$cca.estimate)"
"0","hedges.cca.df$cca.sd <- as.numeric(hedges.cca.df$cca.sd)"
"0",""
"0",""
"0",""
"0","# Prep the data so it has the same colors as the bruvs data"
"0","hedges.cca.plot <- hedges.cca.df %>%"
"0","  mutate(Atoll = ifelse(Site == ""Peros Banhos Lagoon"", ""Peros Banhos"", "
"0","                        ifelse(Site == ""Peros Banhos Seaward"", ""Peros Banhos"","
"0","                        ifelse(Site == ""Salomon Seaward"", ""Salomon"","
"0","                               ifelse(Site == ""Salomon Lagoon"", ""Salomon"","
"0","                                      ifelse(Site == ""Nelson"", ""Nelson"","
"0","                                             ifelse(Site== ""Middle Brother"", ""Brothers"","
"0","                                                    ""Egmont"")))))))"
"0",""
"0",""
"0","hedges.cca.plot$Atoll <- factor(hedges.cca.plot$Atoll, "
"0","                            levels=c(""Brothers"", ""Nelson"", "
"0","                                     ""Peros Banhos"", ""Salomon"", ""Egmont""))"
"0",""
"0",""
"0","# Calculate grand mean"
"0","cca.mean <- hedges.cca.plot %>%"
"0","  summarize(mean=mean(cca.estimate),"
"0","            sd=sd(cca.estimate))"
"0",""
"0","# add back to data"
"0","hedges.cca.plot <- hedges.cca.plot %>%"
"0","  add_row(Site=""Overall"", cca.estimate=cca.mean$mean, cca.sd=cca.mean$sd, Atoll=NA)"
"0",""
"0","hedges.cca.plot$Site <- factor(hedges.cca.plot$Site, "
"0","                           levels=c(""Middle Brother"", ""Nelson"", "
"0","                                    ""Peros Banhos Lagoon"", "
"0","                                    ""Peros Banhos Seaward"", "
"0","                                    ""Salomon Lagoon"", ""Salomon Seaward"", "
"0","                                    ""Il de rats"", ""Il lubine"", "
"0","                                    ""Overall""))"
"0",""
"0",""
"0","# Effect size by site"
"0","p_tiles.cca.effectsize <- ggplot(hedges.cca.plot, "
"0","                                 aes(x=Site, y=cca.estimate, col=Atoll)) +"
"0","   geom_point(size=c(6,6,6,6,6,6,6,6,9), shape=(values=c(19,19,19,19,19,19,19,19,18)))+"
"0","  geom_errorbar(aes(ymin = cca.estimate-cca.sd, "
"0","                    ymax = cca.estimate+cca.sd), "
"0","                width=0.2) +"
"0","  labs (x= """", y= ""CCA Effect Size"") +"
"0","  theme_pubr() +"
"0","  geom_hline(yintercept= 0, linetype=2) +"
"0","    theme_pubr(base_size = 16) + "
"0","  theme(axis.text.x = element_blank())+"
"0","  scale_color_manual(values= c(""#440154FF"",""#3B528BFF"",""#21908CFF"",""#5DC863FF"",""#FDE725FF"", ""black"")) +"
"0","  guides(col = ""none"", shape=""none"")+"
"0","  geom_vline(xintercept=8.5, linetype=""dashed"")"
"0",""
"0","p_tiles.cca.effectsize"
